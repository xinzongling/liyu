<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Document</title>
	<style>
		*{
			margin: 0;
			padding: 0;
		}
		button{
			width: 200px;
			height: 50px;
			cursor: pointer;
		}
		#box{
			width: 300px;
			/* height: 300px; */
			background: red;
			display: none;
			overflow: hidden;
			/* padding-top: 30px;
			padding-bottom: 30px; */
		}
		.fadeout{
			opacity: 0;
			visibility: hidden;
		}
		.transition{
			transition:all 1s;
		}
		.slideUpDownCollapse{
			height: 0 !important;
			padding-top: 0px !important;
			padding-bottom: 0px !important;
		}
	</style>
</head>
<body>
	<button>显示</button>
	<button>隐藏</button>
	<div id="box">
		<p>我是段落1</p>
		<p>我是段落2</p>
		<p>我是段落3</p>
		<p>我是段落4</p>
		<p>我是段落5</p>
		<p>我是段落6</p>
		<p>我是段落7</p>
		<p>我是段落8</p>
		<p>我是段落9</p>
		<p>我是段落10</p> 
	</div>
	<p>我是段落p</p>
</body>
<script src="jQuery/jquery-1.12.4.js"></script>
<script src="transition.js"></script>
<script>
	//共同的初始化方法
	function init($elem,hiddencallback){
		if($elem.is(':hidden')){
			$elem.data('status','hidden');
			if(typeof hiddencallback=='function') hiddencallback();
		}else{
			$elem.data('status','shown');
		}
	};
	function show($elem,callback){
		if($elem.data('status')=='shown')  return;
		if($elem.data('status')=='show')  return;
		$elem.data('status','show').trigger('show');
		callback();
	}
	function hide($elem,callback){
			if($elem.data('status')=='hidden')  return;
			if($elem.data('status')=='hide')  return;
			$elem.data('status','hide').trigger('hide');
			callback();
	}
	var silent={	
		init:function($elem){
			init($elem)
		},
		show:function($elem){  //判断当前状态的目的是为了防止多次触发事件			
			show($elem,function(){
				setTimeout(function(){
					$elem.show(); //改变的其实是display
					$elem.trigger('shown').data('status','shown');
				},1000)
			})			
		},
		hide:function($elem){
			
			hide($elem,function(){
				$elem.hide();
				$elem.trigger('hidden').data('status','hidden');
			});
		}
	};
    //css3实现显示和隐藏
    var css3={
    	//淡入淡出的显示隐藏
    	fade:{
			init:function($elem){
				css3._init($elem,'fadeout');
			},
    		show:function($elem){ 			
    			css3._show($elem,'fadeout');
    		},
    		hide:function($elem){
    			css3._hide($elem,'fadeout');
    		}
    	},
    	//上下卷入的显示和隐藏
    	slideUpDown:{
    		init:function($elem){
    			$elem.height($elem.height());
				css3._init($elem,'slideUpDownCollapse');
			},
    		show:function($elem){ 			
    			css3._show($elem,'slideUpDownCollapse');
    		},
    		hide:function($elem){
    			css3._hide($elem,'slideUpDownCollapse');
    		}
    	}
    };
    css3._init=function($elem,className){
    		$elem.addClass('transition');
			init($elem,function(){
				$elem.addClass(className);	
			});
    }
    css3._show=function($elem,className){
			show($elem,function(){
				$elem.show();
				$elem
				.off(kuazhu.transition.end) //为了解决用户频繁点击触发事件多次执行
				// one只绑定一次事件,并且触发完后就自动移出事件了
				.one(kuazhu.transition.end,function(){
					$elem.trigger('shown').data('status','shown');
				});
				//此处添加定时器的目的是为了等待元素由display:none变为display:block;
				setTimeout(function(){
					$elem.removeClass(className);
				},200);
			})
    }
    css3._hide=function($elem,className){
			hide($elem,function(){
				//过渡完成后触发事件
    			$elem.off(kuazhu.transition.end).one(kuazhu.transition.end,function(){ //one只绑定一次事件
    				console.log('transition..')
    				$elem.hide(); //display:none;
    				$elem.trigger('hidden').data('status','hidden');
    			})
    			//触发了过渡
    			$elem.addClass(className);
    		})
    }
	var $elem=$('#box');
	css3.slideUpDown.init($elem);
	//自定义事件
	$elem.on('show shown hide hidden',function(ev){
		if(ev.type=='show'){
			console.log('show.....')
		}else if(ev.type=='shown'){
			console.log('shown.....')
		}else if(ev.type=='hide'){
			console.log('hide.....')
		}else if(ev.type=='hidden'){
			console.log('hidden.....')
		}		
	});	

	$elem.on('click',function(){
		alert('aa')
	});
	/*
	$('button').eq(0).on('click',function(){
		css3.fade.show($elem);
	});
	$('button').eq(1).on('click',function(){
		css3.fade.hide($elem);
	});*/
	$('button').eq(0).on('click',function(){
		css3.slideUpDown.show($elem);
	});
	$('button').eq(1).on('click',function(){
		css3.slideUpDown.hide($elem);
	});
</script>
</html>